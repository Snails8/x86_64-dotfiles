var q=Object.create;var C=Object.defineProperty;var G=Object.getOwnPropertyDescriptor;var O=Object.getOwnPropertyNames,L=Object.getOwnPropertySymbols,Z=Object.getPrototypeOf,j=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var U=(s,e,t)=>e in s?C(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,B=(s,e)=>{for(var t in e||(e={}))j.call(e,t)&&U(s,t,e[t]);if(L)for(var t of L(e))V.call(e,t)&&U(s,t,e[t]);return s};var z=s=>C(s,"__esModule",{value:!0});var Q=(s,e)=>{z(s);for(var t in e)C(s,t,{get:e[t],enumerable:!0})},K=(s,e,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of O(e))!j.call(s,n)&&n!=="default"&&C(s,n,{get:()=>e[n],enumerable:!(t=G(e,n))||t.enumerable});return s},S=s=>K(z(C(s!=null?q(Z(s)):{},"default",s&&s.__esModule&&"default"in s?{get:()=>s.default,enumerable:!0}:{value:s,enumerable:!0})),s);Q(exports,{activate:()=>Y,deactivate:()=>J});var d=S(require("vscode"));var x=S(require("vscode"));var b=S(require("vscode")),A=class{constructor(e,t){this.signatureEnd=/[\{;]/;this.position=e,this.editor=t,this.setSignature(this.getBlock(e,this.signatureEnd))}test(){return this.pattern.test(this.signature)}match(){return this.signature.match(this.pattern)}setSignature(e){this.signature=e}getBlock(e,t){let n=e.line+1,a=this.editor.document.lineAt(n).text,r=a.search(/[^\s]/);if(r===-1)return"";let c=new b.Position(e.line+1,r);for(;!t.test(a);)n++,a=this.editor.document.lineAt(n).text;let l=new b.Position(n,a.search(t)),p=new b.Range(c,l);return this.editor.document.getText(p)}getEnclosed(e,t,n){let a=0,r=e.split(""),c=0;for(let l=0;l<r.length;l++){let p=r[l];if(p==n&&a==0){c=l;break}else p==n?a--:p==t&&a++;c=l}return e.substr(0,c)}getSplitWithoutEnclosed(e,t=","){let n=new Array,a=e.split(""),r=["{","(","["],c=["}",")","]"],l=0,p=0,o=0;for(let $=0;$<a.length;$++){let T=a[$];if(T===t&&$===a.length-1)break;if(T===t&&l===0){o=$,n.push(e.substr(p,o-p)),p=$+1;continue}else r.indexOf(T)>=0?l++:c.indexOf(T)>=0&&l--;o=$}return e.substr(p,o-p+1).match(/^\s*$/)||n.push(e.substr(p,o-p+1)),n}getClassHead(){if(this.classHead===void 0){let e=this.editor.document.getText(new b.Range(new b.Position(0,0),new b.Position(150,0))),n=/\s*(abstract|final)?\s*(class|trait|interface)/gm.exec(e),a=this.editor.document.positionAt(n.index),r=new b.Range(new b.Position(0,0),a);this.classHead=this.editor.document.getText(r)}return this.classHead}};var W=S(require("vscode"));var M=S(require("vscode")),i=class{constructor(){this.isLive=!0}static get instance(){return this._instance==null&&(this._instance=new this),this._instance}set live(e){this.isLive=e}setFallback(e){this.data=e}override(e){this.data=B(B({},this.data),e)}get(e){return this.isLive?M.workspace.getConfiguration("php-docblocker").get(e):this.data[e]}};var v=class{constructor(e=""){this.params=[];this.indentCharacter=" ";this.message=e}fromObject(e){e.return!==void 0&&(this.return=e.return),e.var!==void 0&&(this.var=e.var),e.message!==void 0&&(this.message=e.message),e.params!==void 0&&Array.isArray(e.params)&&e.params.forEach(t=>{this.params.push(new k(t.type,t.name))})}build(e=!1){let t=i.instance.get("extra"),n=i.instance.get("gap"),a=i.instance.get("returnGap"),c=i.instance.get("alignParams")?i.instance.get("alignReturn"):!1,l="",p="",o="",g="",$="";e&&(n=!0,t=[]),$="${###"+(this.message!=""?":":"")+this.message+"}";let T=this.getMaxParamLength(this.params,this.return);if(this.params.length&&(o="",this.params.forEach(m=>{o!=""&&(o+=`
`);let h=m.type,f=m.name.replace("$","\\$"),H=this.getParamAlignmentSpaces(T,f,h);o+="@param "+(c?this.indentCharacter:"")+"${###:"+h+"} "+H.prepend+f+H.append;let I=i.instance.get("paramDescription");I===!0?o+="${###}":typeof I=="string"&&(o+="${###:"+I+"}")})),this.var){p="@var ${###:"+this.var+"}";let m=i.instance.get("varDescription");m===!0?p+=" ${###}":typeof m=="string"&&(p+=" ${###:"+m+"}")}if(this.return&&(this.return!="void"||i.instance.get("returnVoid"))){let m=this.getReturnAlignmentSpaces(T);l="@return ${###:"+this.return+"}"+m.append;let h=i.instance.get("returnDescription");h===!0?l+="${###}":typeof h=="string"&&(l+="${###:"+h+"}")}Array.isArray(t)&&t.length>0&&(g=t.join(`
`));let y=[];for(let m in this.template){let h=this.template[m],f;m=="message"&&$?(f=$,n&&(h.gapAfter=!0)):m=="var"&&p?f=p:m=="return"&&l?(f=l,a&&(h.gapBefore=!0)):m=="param"&&o?f=o:m=="extra"&&g?f=g:h.content!==void 0&&(f=h.content),f&&h.gapBefore&&y[y.length-1]!=""&&y.push(""),f&&y.push(f),f&&h.gapAfter&&y.push("")}y[y.length-1]==""&&y.pop();let P=y.join(`
`);P=`/**
`+P+`
 */`;let F=0;return P=P.replace(/###/gm,function(){return F++,F+""}),P=P.replace(/^$/gm," *"),P=P.replace(/^(?!(\s\*|\/\*))/gm," * $1"),new W.SnippetString(P)}set template(e){this._template=e}get template(){return this._template==null?{message:{},var:{},param:{},return:{},extra:{}}:this._template}getMaxParamLength(e,t){let n=i.instance.get("alignParams"),a=n?i.instance.get("alignReturn"):!1,r=0,c=0;return e.length&&n&&e.forEach(l=>{let p=l.type;p.length>r&&(r=p.length);let o=l.name.replace("$","\\$");o.length>c&&(c=o.length)}),t&&(t!="void"||i.instance.get("returnVoid"))&&a&&t.length>r&&(r=t.length),{type:r,name:c}}getParamAlignmentSpaces(e,t,n){let a=i.instance.get("alignParams"),r=i.instance.get("paramDescription"),c="",l="";return a&&(c=Array(e.type-n.length).fill(this.indentCharacter).join(""),l=Array(1+e.name-t.length).fill(this.indentCharacter).join("")),{append:r?a?l:this.indentCharacter:"",prepend:c}}getReturnAlignmentSpaces(e){let n=i.instance.get("alignParams")?i.instance.get("alignReturn"):!1,a=i.instance.get("returnDescription"),r="";return n&&(r=Array(1+e.type-this.return.length).fill(this.indentCharacter).join("")+Array(e.name).fill(this.indentCharacter).join("")),{append:a?n?r:this.indentCharacter:"",prepend:""}}},k=class{constructor(e,t){this.type=e,this.name=t}};var u=class{static get instance(){return this._instance||(this._instance=new this)}getResolvedTypeHints(e,t=null){let n=e.split("|");for(let a=0;a<n.length;a++)n[a]=this.getFullyQualifiedType(n[a],t),n[a]=this.getFormattedTypeByName(n[a]);return n.join("|")}getFullyQualifiedType(e,t){if(!i.instance.get("qualifyClassNames"))return e;let a=new RegExp("use\\s+([^ ]*?)((?:\\s+as\\s+))?("+e+");","gm").exec(t);return a!=null&&a[3]==e?(a[1].charAt(0)!="\\"&&(a[1]="\\"+a[1]),a[2]!=null?a[1]:a[1]+e):e}getFormattedTypeByName(e){switch(e){case"bool":case"boolean":return i.instance.get("useShortNames")?"bool":"boolean";case"int":case"integer":return i.instance.get("useShortNames")?"int":"integer";default:return e}}getTypeFromValue(e){let t;return e.match(/^\s*(false|true)\s*$/i)!==null||e.match(/^\s*\!/i)!==null?this.getFormattedTypeByName("bool"):e.match(/^\s*([\d-]+)\s*$/)!==null?this.getFormattedTypeByName("int"):e.match(/^\s*([\d.-]+)\s*$/)!==null?"float":e.match(/^\s*(["'])/)!==null||e.match(/^\s*<<</)!==null?"string":e.match(/^\s*(array\(|\[)/)!==null?"array":"[type]"}};var N=class extends A{constructor(){super(...arguments);this.pattern=/^\s*((.*)(protected|private|public))?(.*)?\s*function\s+&?([a-z0-9_]+)\s*\(([^{;]*)/im}parse(){let e=this.match(),t=new v("Undocumented function");t.template=i.instance.get("functionTemplate");let n=this.getEnclosed(e[6],"(",")"),a;if(n!=""){let l=this.getSplitWithoutEnclosed(n);i.instance.get("qualifyClassNames")&&(a=this.getClassHead());for(let p=0;p<l.length;p++){let g=l[p].match(/^\s*(?:(?:public|protected|private)\s+)?(\?)?\s*([A-Za-z0-9|_\\]+)?\s*\&?((?:[.]{3})?\$[A-Za-z0-9_]+)\s*\=?\s*(.*)\s*/im);var r="[type]";g[2]!=null&&(r=u.instance.getResolvedTypeHints(g[2],a)),g[2]!=null&&g[1]==="?"||g[2]!=null&&g[4]!=null&&g[2]!="mixed"&&g[4]=="null"?r+="|null":g[4]!=null&&g[4]!=""&&g[2]!="mixed"&&(r=u.instance.getFormattedTypeByName(u.instance.getTypeFromValue(g[4]))),t.params.push(new k(r,g[3]))}}let c=this.signature.match(/.*\)\s*\:\s*(\?)?\s*([a-zA-Z_|0-9\\]+)\s*$/m);return c!=null?(c[2]=u.instance.getResolvedTypeHints(c[2],this.getClassHead()),t.return=c[1]==="?"?u.instance.getFormattedTypeByName(c[2])+"|null":u.instance.getFormattedTypeByName(c[2])):t.return=this.getReturnFromName(e[5]),t}getReturnFromName(e){if(/^(is|has|can|should)(?:[A-Z0-9_]|$)/.test(e))return u.instance.getFormattedTypeByName("bool");switch(e){case"__construct":case"__destruct":case"__set":case"__unset":case"__wakeup":return null;case"__isset":return u.instance.getFormattedTypeByName("bool");case"__sleep":case"__debugInfo":return"array";case"__toString":return"string"}return"void"}};var _=class extends A{constructor(){super(...arguments);this.pattern=/^\s*(static)?\s*(protected|private|public)\s+(static)?\s*(\??\\?[a-zA-Z_\x7f-\xff][a-zA-Z0-9|_\x7f-\xff\\]+)?\s*(\$[A-Za-z0-9_]+)\s*\=?\s*([^;]*)/m}parse(){let e=this.match(),t=new v("Undocumented variable");if(t.template=i.instance.get("propertyTemplate"),e[4]){let n=e[4].match(/(\?)?(.*)/m),a;i.instance.get("qualifyClassNames")&&(a=this.getClassHead());let r=u.instance.getResolvedTypeHints(n[2],a);r=u.instance.getFormattedTypeByName(r),n[1]==="?"&&(r+="|null"),t.var=r}else e[6]?t.var=u.instance.getTypeFromValue(e[6]):t.var="[type]";return t}};var R=class extends A{constructor(){super(...arguments);this.pattern=/^\s*(abstract|final)?\s*(class|trait|interface)\s+([a-z0-9_]+)\s*/i}parse(){let e=this.match(),t=new v("Undocumented "+e[2]);return t.template=i.instance.get("classTemplate"),t}};var w=class{constructor(e,t){this.targetPosition=e.start,this.editor=t}autoDocument(){let e=new N(this.targetPosition,this.editor);if(e.test())return e.parse().build();let t=new _(this.targetPosition,this.editor);if(t.test())return t.parse().build();let n=new R(this.targetPosition,this.editor);return n.test()?n.parse().build():new v().build(!0)}};var D=class{constructor(){this.tagList=[{tag:"@api",snippet:"@api"},{tag:"@abstract",snippet:"@abstract"},{tag:"@after",snippet:"@after"},{tag:"@afterClass",snippet:"@afterClass"},{tag:"@author",snippet:"@author ${1:{{name}}} <${2:{{email}}}>"},{tag:"@backupGlobals",snippet:"@backupGlobals ${1:switch}"},{tag:"@backupStaticAttributes",snippet:"@backupStaticAttributes ${1:switch}"},{tag:"@before",snippet:"@before"},{tag:"@beforeClass",snippet:"@beforeClass"},{tag:"@category",snippet:"@category ${1:description}"},{tag:"@codeCoverageIgnore",snippet:"@codeCoverageIgnore"},{tag:"@codeCoverageIgnoreEnd",snippet:"@codeCoverageIgnoreEnd"},{tag:"@codeCoverageIgnoreStart",snippet:"@codeCoverageIgnoreStart"},{tag:"@copyright",snippet:"@copyright ${1:"+new Date().getFullYear()+"} ${2:Name}"},{tag:"@covers",snippet:"@covers ${1:fqcn}"},{tag:"@coversDefaultClass",snippet:"@coversDefaultClass ${1:fqcn}"},{tag:"@coversNothing",snippet:"@coversNothing"},{tag:"@dataProvider",snippet:"@dataProvider ${1:methodName}"},{tag:"@depends",snippet:"@depends ${1:methodName}"},{tag:"@deprecated",snippet:"@deprecated ${1:version}"},{tag:"@doesNotPerformAssertions",snippet:"@doesNotPerformAssertions"},{tag:"@example",snippet:"@example ${1:location} ${2:description}"},{tag:"@filesource",snippet:"@filesource"},{tag:"@final",snippet:"@final"},{tag:"@group",snippet:"@group ${1:group}"},{tag:"@global",snippet:"@global"},{tag:"@ignore",snippet:"@ignore ${1:description}"},{tag:"@inheritDoc",snippet:"@inheritDoc"},{tag:"@internal",snippet:"@internal ${1:description}"},{tag:"@large",snippet:"@large"},{tag:"@license",snippet:"@license ${1:MIT}"},{tag:"@link",snippet:"@link ${1:http://url.com}"},{tag:"@medium",snippet:"@medium"},{tag:"@method",snippet:"@method ${1:mixed} ${2:methodName()}"},{tag:"@mixin",snippet:"@mixin ${1:\\MyClass}"},{tag:"@package",snippet:"@package ${1:category}"},{tag:"@param",snippet:"@param ${1:mixed} $${2:name}"},{tag:"@preserveGlobalState",snippet:"@preserveGlobalState ${1:switch}"},{tag:"@property",snippet:"@property ${1:mixed} $${2:name}"},{tag:"@property-read",snippet:"@property-read ${1:mixed} $${2:name}"},{tag:"@property-write",snippet:"@property-write ${1:mixed} $${2:name}"},{tag:"@requires",snippet:"@requires ${1:mixed}"},{tag:"@return",snippet:"@return ${1:mixed}"},{tag:"@runInSeparateProcess",snippet:"@runInSeparateProcess"},{tag:"@runTestsInSeparateProcesses",snippet:"@runTestsInSeparateProcesses"},{tag:"@see",snippet:"@see ${1:http://url.com}"},{tag:"@since",snippet:"@since ${1:1.0.0}"},{tag:"@small",snippet:"@small"},{tag:"@source",snippet:"@source ${1:location} ${2:description}"},{tag:"@static",snippet:"@static"},{tag:"@subpackage",snippet:"@subpackage ${1:category}"},{tag:"@test",snippet:"@test"},{tag:"@testdox",snippet:"@testdox ${1:description}"},{tag:"@testWith",snippet:"@testWith ${1:elements}"},{tag:"@throws",snippet:"@throws ${1:Exception}"},{tag:"@ticket",snippet:"@ticket ${1:ticket}"},{tag:"@todo",snippet:"@todo ${1:Something}"},{tag:"@uses",snippet:"@uses ${1:MyClass::function} ${2:Name}"},{tag:"@var",snippet:"@var ${1:mixed}"},{tag:"@version",snippet:"@version ${1:1.0.0}"},{tag:"@psalm-var (Psalm)",snippet:"@psalm-var ${1:mixed}"},{tag:"@psalm-param (Psalm)",snippet:"@psalm-param ${1:mixed} $${2:name}"},{tag:"@psalm-return (Psalm)",snippet:"@psalm-return ${1:mixed}"},{tag:"@psalm-suppress (Psalm)",snippet:"@psalm-suppress ${1:IssueName}"},{tag:"@psalm-assert (Psalm)",snippet:"@psalm-assert ${1:[assertion]} $${2:var}"},{tag:"@psalm-assert-if-true (Psalm)",snippet:"@psalm-assert-if-true ${1:[assertion]} $${2:var}"},{tag:"@psalm-assert-if-false (Psalm)",snippet:"@psalm-assert-if-false ${1:[assertion]} $${2:var}"},{tag:"@psalm-ignore-nullable-return (Psalm)",snippet:"@psalm-ignore-nullable-return"},{tag:"@psalm-ignore-falsable-return (Psalm)",snippet:"@psalm-ignore-falsable-return"},{tag:"@psalm-seal-properties (Psalm)",snippet:"@psalm-seal-properties"},{tag:"@psalm-internal (Psalm)",snippet:"@psalm-internal ${1:Namespace}"},{tag:"@psalm-readonly (Psalm)",snippet:"@psalm-readonly"},{tag:"@psalm-mutation-free (Psalm)",snippet:"@psalm-mutation-free"},{tag:"@psalm-external-mutation-free (Psalm)",snippet:"@psalm-external-mutation-free"},{tag:"@psalm-immutable (Psalm)",snippet:"@psalm-immutable"},{tag:"@psalm-pure (Psalm)",snippet:"@psalm-pure"},{tag:"@phan-suppress (Phan)",snippet:"@phan-suppress ${1:IssueName}"},{tag:"@suppress (Phan)",snippet:"@suppress ${1:IssueName}"},{tag:"@phan-suppress-current-line (Phan)",snippet:"@phan-suppress-current-line ${1:IssueName, IssueName}"},{tag:"@phan-suppress-next-line (Phan)",snippet:"@phan-suppress-next-line ${1:IssueName, IssueName}"},{tag:"@phan-file-suppress (Phan)",snippet:"@phan-file-suppress ${1:IssueName}"},{tag:"@override (Phan)",snippet:"@override"},{tag:"@inherits (Phan)",snippet:"@inherits"},{tag:"@phan-assert (Phan)",snippet:"@phan-assert ${1:[assertion]} $${2:var}"},{tag:"@phan-assert-true-condition (Phan)",snippet:"@phan-assert-true-condition ${1:[assertion]} $${2:var}"},{tag:"@phan-assert-false-condition (Phan)",snippet:"@phan-assert-false-condition ${1:[assertion]} $${2:var}"},{tag:"@phan-closure-scope (Phan)",snippet:"@phan-closure-scope"},{tag:"@phan-read-only (Phan)",snippet:"@phan-read-only"},{tag:"@phan-write-only (Phan)",snippet:"@phan-write-only"},{tag:"@phan-pure (Phan)",snippet:"@phan-pure"},{tag:"@phan-phan-output-reference (Phan)",snippet:"@param ${1:mixed} $${2:name} @phan-phan-output-reference"},{tag:"@phan-phan-ignore-reference (Phan)",snippet:"@param ${1:mixed} $${2:name} @phan-phan-ignore-reference"},{tag:"@phan-var (Phan)",snippet:"@phan-var ${1:mixed}"},{tag:"@phan-param (Phan)",snippet:"@phan-param ${1:mixed} $${2:name}"},{tag:"@phan-return (Phan)",snippet:"@phan-return ${1:mixed}"},{tag:"@phan-return (Phan)",snippet:"@phan-return ${1:mixed}"},{tag:"@phan-method (Phan)",snippet:"@phan-method ${1:mixed} ${2:methodName()}"},{tag:"@template (Phan)",snippet:"@template"}]}get list(){return this.tagList}};var E=class{constructor(){this.tags=new D}provideCompletionItems(e,t,n){let a=[],r;if((r=e.getWordRangeAtPosition(t,/\/\*\*/))!==void 0){let p=new w(r,x.window.activeTextEditor),o=new x.CompletionItem("/**",x.CompletionItemKind.Snippet);o.detail="PHP DocBlocker",o.documentation="Generate a PHP DocBlock from the code snippet below.";let g=e.getWordRangeAtPosition(t,/\/\*\* \*\//);return o.range=g,o.insertText=p.autoDocument(),a.push(o),a}if((r=e.getWordRangeAtPosition(t,/\@[a-z]*/))===void 0)return a;let c=e.getText(r);return this.getTags().filter(p=>p.tag.match(c)!==null).forEach(p=>{let o=new x.CompletionItem(p.tag,x.CompletionItemKind.Snippet);o.range=r,o.insertText=new x.SnippetString(p.snippet),a.push(o)}),a}getTags(){let e=this.tags.list;return e.forEach((t,n)=>{t.tag=="@author"&&(t.snippet=t.snippet.replace("{{name}}",i.instance.get("author").name),t.snippet=t.snippet.replace("{{email}}",i.instance.get("author").email),e[n]=t)}),e}};function Y(s){["php","hack"].forEach(e=>{e=="hack"&&d.languages.setLanguageConfiguration(e,{wordPattern:/(-?\d*\.\d\w*)|([^\-\`\~\!\@\#\%\^\&\*\(\)\=\+\[\{\]\}\\\|\;\:\'\"\,\.\<\>\/\?\s]+)/g,onEnterRules:[{beforeText:/^\s*\/\*\*(?!\/)([^\*]|\*(?!\/))*$/,afterText:/^\s*\*\/$/,action:{indentAction:d.IndentAction.IndentOutdent,appendText:" * "}},{beforeText:/^\s*\/\*\*(?!\/)([^\*]|\*(?!\/))*$/,action:{indentAction:d.IndentAction.None,appendText:" * "}},{beforeText:/^(\t|(\ \ ))*\ \*(\ ([^\*]|\*(?!\/))*)?$/,action:{indentAction:d.IndentAction.None,appendText:"* "}},{beforeText:/^(\t|(\ \ ))*\ \*\/\s*$/,action:{indentAction:d.IndentAction.None,removeText:1}}]}),d.languages.registerCompletionItemProvider(e,new E,"*","@")}),d.commands.registerTextEditorCommand("php-docblocker.trigger",e=>{e.selection=new d.Selection(e.selection.start,e.selection.start);let t=new d.Range(e.selection.start,e.selection.end),a=new w(t,e).autoDocument();e.insertSnippet(a)})}function J(){}0&&(module.exports={activate,deactivate});
